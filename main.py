import module_db as mldb

if __name__ == "__main__":
    
    """
    Create a new database object
    This object is for the Malware Bazaar Database
    Please set your API key
    """
    db_bazaar = mldb.Database("Bazaar", 
                  "API-KEY-BAZAAR", 
                  "https://bazaar.abuse.ch/export/csv/recent", 
                  ["first_seen_utc","sha256_hash", "file_name", "file_type_guess", "signature", "clamav", "vtpercent"],
                  True)
    
    """
    Create a new database object
    This object is for the Malshare Database
    Please set your API key
    """
    db_malshare = mldb.Database("Malshare", 
                  "API-KEY-MALSHARE", 
                  "https://malshare.com/daily/malshare.current.sha256.txt", 
                  None,
                  False)
    """
    Downloaded raw databases for Malware Bazaar and Malshare
    """
    if(db_bazaar.createDatabase(467) == False):
        print("Failed to download database")
        
    if(db_malshare.createDatabase(0) == False):
        print("Failed to download database")
    
    """
    Generate new full database
    """
    if(mldb.generateFullDB(db_bazaar, db_malshare) == False):
        print("Failed to create database")

"""
TODO 
Allow recent/full/monthly updates to each DB
Add lookup table to file types
"""
