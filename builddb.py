import module_db as mldb

if __name__ == "__main__":
    
    """
    Create a new database object
    This object is for the Malware Bazaar Database
    Please set your API key
    """
    db_bazaar = mldb.Database("Bazaar", 
                  "90242bb725e3120c83fab130886261d5", 
                  "https://bazaar.abuse.ch/export/csv/recent", 
                  ["first_seen_utc","sha256_hash", "file_name", "file_type_guess", "signature", "clamav", "vtpercent"])
    
    """
    Create a new database object
    This object is for the Malshare Database
    Please set your API key
    """
    db_malshare = mldb.Database("Malshare", 
                  "b8fb2362ef478d1db2ee5c2f4c25c4b5d84e0e50d6f3d6fc59c7d149e9ecaf84", 
                  "https://malshare.com/daily/malshare.current.sha256.txt", 
                  None)
    
    """
    Downloaded raw databases for Malware Bazaar and Malshare
    """
    db_bazaar.createDatabase(467)
    db_malshare.createDatabase(0)
    
    """
    Generate new full database
    """
    mldb.generateFullDB(db_bazaar, db_malshare)
    

"""
TODO 
Allow recent/full/monthly updates to each DB
Add lookup table to file types
"""